# Contributors

This page is intended for people interested in building new or modified functionality for Jupyter AI.

If you would like to build applications that enhance Jupyter AI, please see the {doc}`developer's guide </developers/index>`.

## Design principles

Maintainers of Jupyter AI have adopted principles that contributors should also follow. These principles, which build on top of [the Zen of Python](https://peps.python.org/pep-0020/), are intended to earn users' trust by keeping their data under their control. The following list is non-exhaustive; maintainers have discretion to interpret and revise these principles.

1. Jupyter AI is **vendor-agnostic**. Jupyter AI does not discriminate between available models, and gives users a choice of model providers. A feature in Jupyter AI may be specific to one model or model provider if it cannot be used with other models or providers.
2. Jupyter AI **only responds to an explicit prompt**; it does not watch files and it does not send prompts automatically. Any change that watches user files must be opt-in only.
3. Jupyter AI is **transparent** with its chat prompts. The chat interface and magic commands use system messages and prompt templates that are open source, so that users know what gets sent to language models.
4. Jupyter AI is **traceable**; users know when it has been used to generate content. When Jupyter AI generates a notebook, the notebook says that it was generated by Jupyter AI. When a user runs a Jupyter AI magic command in a notebook, output cells say, in their metadata, that they were generated by Jupyter AI.
5. Jupyter AI uses a **human-centered design**. The chat interface should look and feel like chat applications that are generally available. The magic commands should look and work like other IPython magic commands. Settings screens should be used minimally, and wherever they are used, they should be readable and understandable, even for users not fluent in the user interface language.

Issues and pull requests that violate the above principles may be declined. If you are unsure about whether your idea is a good fit for Jupyter AI, please [open an issue](https://github.com/jupyterlab/jupyter-ai/issues/new/choose) so that our maintainers can discuss it with you.

## Prerequisites

You can develop Jupyter AI on any system that can run a supported Python version up to and including 3.12, including recent Windows, macOS, and Linux versions.

You should have the newest supported version of JupyterLab installed.

You will need [a supported version of node.js](https://github.com/nodejs/release#release-schedule) to use Jupyter AI.

## Automatic development setup (recommended)

To get a development setup automatically, you must first install a Python
environment manager. The development setup script currently supports
`micromamba`, `mamba`, or `conda`.

We recommend
[micromamba](https://micromamba.readthedocs.io/en/latest/installation.html) for
its speed and minimal footprint. Alternatively, you can install
[mamba](https://mamba.readthedocs.io/en/latest/installation.html) or
[conda](https://conda.io/projects/conda/en/latest/user-guide/install/index.html).

Then, clone the repository and run the development setup script:

```
# Clone the repository
git clone https://github.com/jupyterlab/jupyter-ai.git
cd jupyter-ai

# Run the development setup script
./scripts/dev-setup.sh
```

This script will automatically create and set up a Jupyter AI development
environment named `jaidev` for you, using the environment manager available on
your system. Specifically, this script will:

- Detect your Python environment manager (micromamba, mamba, or conda),
- Create a 'jaidev' Python environment with Python 3.11, Node.js 20, JupyterLab 4.4+, and `uv`,
- Install all JavaScript dependencies,
- Builds all frontend assets,
- Perform editable installation of all Jupyter AI packages, and
- Install documentation dependencies.

After this is complete, you can start and launch JupyterLab in your default
browser by running `jlpm dev` or simply `jupyter lab`.

## Manual development setup

To perform a minimal development setup in another Python environment without
using `dev-setup.sh`, first verify that the below prerequisites are installed in
your environment:

- Python 3.9 - 3.11

- JupyterLab >=4.4

- Any [maintained](https://github.com/nodejs/release#release-schedule) version of `nodejs`

- [`uv`](https://docs.astral.sh/uv/)

Then, run these commands:

```py
# Install JS dependencies
jlpm

# Build frontend assets
jlpm build

# Perform editable installation of all Jupyter AI packages
# This can also be done via the alias `jlpm di`
jlpm dev:install
```

## Development builds

You can open a new terminal and use that to build local changes to the
repository. Make sure to activate the `jaidev` environment each time you begin
development from a new terminal:

```
{micromamba,mamba,conda} activate jaidev

# Build frontend assets
jlpm build
```

`jlpm build` only needs to be run after modifying anything related to the
frontend (e.g. `*.ts`, `*.tsx`, `*.css` files). The browser has to be refreshed
to reflect new changes to the frontend.

To only build a subset of Jupyter AI packages, use the `--scope` argument that
gets forwarded to Lerna:

```
# Builds frontend assets only for `packages/jupyter-ai` and its dependencies
jlpm build --scope "@jupyter-ai/core"
```

Note that after making changes to anything backend-related (e.g. `*.py` files),
you must restart the server for those changes to take effect. You can restart
the server by first typing `Ctrl + C` in the terminal running it, then running
`jlpm dev` or `jupyter lab` to restart it.

## Development reinstall

To reinstall all Jupyter AI packages, run:

```
# reinstalls all Jupyter AI packages
jlpm dev:reinstall

# or, use the convenient alias:
jlpm dr
```

This is generally necessary when updating `pyproject.toml` files.

## Building documentation

The `./scripts/dev-setup.sh` should automatically install the documentation
dependencies. You will need to install [pandoc](https://pandoc.org/) as well. You can install [pandoc from the conda-forge channel](https://anaconda.org/conda-forge/pandoc):

```
conda install -c conda-forge pandoc
```

Otherwise have a look at pandoc's [installation instructions](https://pandoc.org/installing.html).


To build the documentation locally, run

```
cd docs/
make html
```

and open `file://<JUPYTER-AI-ABSOLUTE-PATH>/docs/build/html/index.html`, where
`<JUPYTER-AI-ABSOLUTE-PATH>` is the absolute path of the Jupyter AI monorepo on
your local filesystem. It is helpful to bookmark this path in your browser of
choice to easily view your local documentation build.

After making any changes, make sure to rebuild the documentation locally via
`make html`, and then refresh your browser to verify the changes visually.


## Development uninstall

To uninstall your Jupyter AI development environment, deactivate and remove the Conda environment:

```
conda deactivate
conda env remove -n jupyter-ai
```

## Testing

### Integration / E2E tests

This extension uses Playwright for the integration / E2E tests (user-level tests).
More precisely, the JupyterLab helper
[Galata](https://github.com/jupyterlab/jupyterlab/tree/master/galata) is used to
test the extension in JupyterLab.

Install test dependencies (needed only once):

```sh
cd ./packages/jupyter-ai/ui-tests/
jlpm install
jlpm playwright install
```

Tests involve snapshot comparisons against a reference snapshots generated by the Github CI. If you are using an OS other than Linux, you will need to generate local snapshots before running the tests locally for the first time. To do this, execute the command:

```sh
cd ./packages/jupyter-ai/ui-tests/
jlpm test:update
```

To execute tests, run:

```sh
cd ./packages/jupyter-ai/ui-tests/
jlpm test
```

You can find more information in the
[ui-tests](https://github.com/jupyterlab/jupyter-ai/tree/main/packages/jupyter-ai/ui-tests)
README.
